<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satisfactory Interactive Map</title>
    <link rel="stylesheet" href="styles/map.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header Navigation -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <span class="logo-text">Satisfactory Hub</span>
                </div>
                <nav class="nav-pills">
                    <a href="index.html" class="nav-pill active">
                        <span class="nav-icon">üó∫Ô∏è</span>
                        Interactive Map
                    </a>
                    <a href="kanban.html" class="nav-pill">
                        <span class="nav-icon">üìã</span>
                        Project Board
                    </a>
                    <a href="calculator.html" class="nav-pill">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        Calculator
                    </a>
                </nav>
                <div class="header-actions">
                    <button class="action-btn" id="saveDataBtn" title="Save Map Data">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                        </svg>
                    </button>
                    <button class="action-btn" id="loadDataBtn" title="Load Map Data">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- Enhanced Sidebar -->
            <aside class="sidebar">
                <!-- Layer Controls -->
                <div class="control-section">
                    <h3 class="section-title">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        Map Layers
                    </h3>
                    <div class="layer-controls">
                        <div class="layer-group">
                            <button class="layer-toggle active" data-layer="resources">
                                <span class="layer-icon">‚õèÔ∏è</span>
                                <span class="layer-label">Resource Nodes</span>
                                <span class="layer-count" id="resourceCount">0</span>
                            </button>
                            <div class="sub-layers" data-parent="resources">
                                <button class="sub-layer-toggle active" data-layer="iron">Iron Ore</button>
                                <button class="sub-layer-toggle active" data-layer="copper">Copper Ore</button>
                                <button class="sub-layer-toggle active" data-layer="coal">Coal</button>
                                <button class="sub-layer-toggle active" data-layer="oil">Crude Oil</button>
                                <button class="sub-layer-toggle active" data-layer="limestone">Limestone</button>
                                <button class="sub-layer-toggle active" data-layer="caterium">Caterium</button>
                                <button class="sub-layer-toggle active" data-layer="sulfur">Sulfur</button>
                                <button class="sub-layer-toggle active" data-layer="uranium">Uranium</button>
                            </div>
                        </div>
                        
                        <button class="layer-toggle active" data-layer="powerslugs">
                            <span class="layer-icon">‚ö°</span>
                            <span class="layer-label">Power Slugs</span>
                            <span class="layer-count" id="powerslugCount">0</span>
                        </button>
                        
                        <button class="layer-toggle active" data-layer="players">
                            <span class="layer-icon">üë§</span>
                            <span class="layer-label">Players & Bases</span>
                            <span class="layer-count" id="playerCount">0</span>
                        </button>
                        
                        <button class="layer-toggle active" data-layer="structures">
                            <span class="layer-icon">üè≠</span>
                            <span class="layer-label">Structures</span>
                            <span class="layer-count" id="structureCount">0</span>
                        </button>
                        
                        <button class="layer-toggle active" data-layer="landmarks">
                            <span class="layer-icon">üèîÔ∏è</span>
                            <span class="layer-label">Landmarks</span>
                            <span class="layer-count" id="landmarkCount">0</span>
                        </button>
                    </div>
                </div>

                <!-- Tools Section -->
                <div class="control-section">
                    <h3 class="section-title">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
                        </svg>
                        Map Tools
                    </h3>
                    <div class="tool-grid">
                        <button class="tool-btn" id="addMarkerBtn" title="Add New Marker">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                            </svg>
                            <span>Add Marker</span>
                        </button>
                        
                        <button class="tool-btn" id="measureBtn" title="Measure Distance">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM8 16H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V6h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V6h2v2z"/>
                            </svg>
                            <span>Measure</span>
                        </button>
                        
                        <button class="tool-btn" id="drawBtn" title="Draw on Map">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                            </svg>
                            <span>Draw</span>
                        </button>
                        
                        <button class="tool-btn" id="uploadMapBtn" title="Upload Custom Map">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            <span>Upload Map</span>
                        </button>
                        
                        <button class="tool-btn danger" id="clearBtn" title="Clear Custom Markers">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                            </svg>
                            <span>Clear All</span>
                        </button>
                        
                        <button class="tool-btn" id="searchBtn" title="Search Map">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                            </svg>
                            <span>Search</span>
                        </button>
                    </div>
                </div>

                <!-- Coordinates Display -->
                <div class="control-section">
                    <h3 class="section-title">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z"/>
                        </svg>
                        Coordinates
                    </h3>
                    <div class="coordinates-display">
                        <div class="coord-item">
                            <span class="coord-label">Mouse:</span>
                            <code id="mouseCoords">X: 0, Y: 0</code>
                        </div>
                        <div class="coord-item">
                            <span class="coord-label">Selected:</span>
                            <code id="selectedCoords">None</code>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="control-section">
                    <h3 class="section-title">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16,11V3H8V9H2V21H22V11H16M10,5H14V11H16V19H18V13H20V19H4V11H6V9H8V19H10V5Z"/>
                        </svg>
                        Map Statistics
                    </h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value" id="totalMarkers">0</span>
                            <span class="stat-label">Total Markers</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="zoomLevel">100%</span>
                            <span class="stat-label">Zoom Level</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Map Container -->
            <div class="map-wrapper">
                <div class="map-container" id="mapContainer">
                    <!-- Map Grid Overlay -->
                    <div class="map-grid" id="mapGrid"></div>
                    
                    <!-- Drawing Canvas -->
                    <canvas class="drawing-canvas" id="drawingCanvas"></canvas>
                    
                    <!-- Measurement Canvas -->
                    <canvas class="measurement-canvas" id="measurementCanvas"></canvas>
                    
                    <!-- Sample Markers -->
                    <div class="marker resource-marker iron pure" style="left: 15%; top: 20%;" 
                         data-type="iron" data-id="iron-1" data-grade="pure"
                         title="Pure Iron Node - Grass Fields">
                        <div class="marker-icon">Fe</div>
                        <div class="marker-glow"></div>
                    </div>
                    
                    <div class="marker resource-marker copper normal" style="left: 25%; top: 30%;" 
                         data-type="copper" data-id="copper-1" data-grade="normal"
                         title="Normal Copper Node - Rocky Desert">
                        <div class="marker-icon">Cu</div>
                        <div class="marker-glow"></div>
                    </div>
                    
                    <div class="marker powerslug-marker purple" style="left: 55%; top: 25%;" 
                         data-type="powerslug" data-id="slug-1" data-grade="purple"
                         title="Purple Power Slug">
                        <div class="marker-icon">‚ö°</div>
                        <div class="marker-glow"></div>
                    </div>
                    
                    <div class="marker player-marker" style="left: 50%; top: 60%;" 
                         data-type="player" data-id="player-1"
                         title="Main Base">
                        <div class="marker-icon">üè†</div>
                        <div class="marker-glow"></div>
                    </div>
                </div>

                <!-- Map Controls -->
                <div class="map-controls">
                    <div class="zoom-controls">
                        <button class="control-btn" id="zoomInBtn" title="Zoom In">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                            </svg>
                        </button>
                        <button class="control-btn" id="zoomOutBtn" title="Zoom Out">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,13H5V11H19V13Z"/>
                            </svg>
                        </button>
                        <button class="control-btn" id="resetZoomBtn" title="Reset View">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="view-controls">
                        <button class="control-btn" id="fullscreenBtn" title="Toggle Fullscreen">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7,14H5V19H10V17H7V14M12,14H14V17H17V19H12V14M17,10V7H14V5H19V10H17M10,5V7H7V10H5V5H10Z"/>
                            </svg>
                        </button>
                        <button class="control-btn" id="gridToggleBtn" title="Toggle Grid">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8,7V17H16V7H8M10,9H14V15H10V9Z"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Mini Map -->
                <div class="mini-map" id="miniMap">
                    <div class="mini-map-content">
                        <div class="mini-viewport"></div>
                    </div>
                </div>
            </div>

            <!-- Info Panel -->
            <div class="info-panel" id="infoPanel">
                <div class="panel-header">
                    <h3>Marker Details</h3>
                    <button class="close-btn" id="closePanelBtn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                        </svg>
                    </button>
                </div>
                <div class="panel-content" id="panelContent">
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22S19,14.25 19,9A7,7 0 0,0 12,2Z"/>
                        </svg>
                        <p>Click on a marker to view details</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Marker Creation Modal -->
    <div class="modal" id="markerModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Marker</h3>
                <button class="close-btn" id="closeModalBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                    </svg>
                </button>
            </div>
            
            <form class="modal-form" id="markerForm">
                <div class="form-group">
                    <label for="markerType">Marker Type</label>
                    <select id="markerType" required>
                        <optgroup label="Resources">
                            <option value="iron">Iron Ore</option>
                            <option value="copper">Copper Ore</option>
                            <option value="coal">Coal</option>
                            <option value="oil">Crude Oil</option>
                            <option value="limestone">Limestone</option>
                            <option value="caterium">Caterium</option>
                            <option value="sulfur">Sulfur</option>
                            <option value="uranium">Uranium</option>
                        </optgroup>
                        <optgroup label="Items">
                            <option value="powerslug">Power Slug</option>
                        </optgroup>
                        <optgroup label="Locations">
                            <option value="player">Player Base</option>
                            <option value="structure">Structure</option>
                            <option value="landmark">Landmark</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="markerTitle">Title</label>
                    <input type="text" id="markerTitle" placeholder="Enter marker name" required>
                </div>
                
                <div class="form-group">
                    <label for="markerDescription">Description</label>
                    <textarea id="markerDescription" placeholder="Optional description" rows="3"></textarea>
                </div>
                
                <div class="form-group" id="resourceGradeGroup" style="display: none;">
                    <label for="resourceGrade">Resource Grade</label>
                    <select id="resourceGrade">
                        <option value="impure">Impure (30/min)</option>
                        <option value="normal">Normal (60/min)</option>
                        <option value="pure">Pure (120/min)</option>
                    </select>
                </div>
                
                <div class="form-group" id="powerslugGradeGroup" style="display: none;">
                    <label for="powerslugGrade">Power Slug Type</label>
                    <select id="powerslugGrade">
                        <option value="green">Green (+1 Power Shard)</option>
                        <option value="yellow">Yellow (+2 Power Shards)</option>
                        <option value="purple">Purple (+5 Power Shards)</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3M19,19H5V5H16.17L19,7.83V19M12,12C10.34,12 9,13.34 9,15C9,16.66 10.34,18 12,18C13.66,18 15,16.66 15,15C15,13.34 13.66,12 12,12M6,6H15V10H6V6Z"/>
                        </svg>
                        Save Marker
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Search Modal -->
    <div class="modal" id="searchModal">
        <div class="modal-backdrop"></div>
        <div class="modal-content search-modal">
            <div class="modal-header">
                <h3>Search Map</h3>
                <button class="close-btn" id="closeSearchBtn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                    </svg>
                </button>
            </div>
            
            <div class="search-content">
                <div class="search-input-group">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Search markers..." autocomplete="off">
                </div>
                
                <div class="search-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="resources">Resources</button>
                    <button class="filter-btn" data-filter="powerslugs">Power Slugs</button>
                    <button class="filter-btn" data-filter="players">Players</button>
                    <button class="filter-btn" data-filter="structures">Structures</button>
                </div>
                
                <div class="search-results" id="searchResults">
                    <!-- Results will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden File Input -->
    <input type="file" id="mapUpload" accept="image/*" style="display: none;">
    <input type="file" id="dataUpload" accept=".json" style="display: none;">

    <!-- JavaScript -->
    <script src="scripts/map.js"></script>
</body>
</html>